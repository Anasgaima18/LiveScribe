# Testing Guide - LiveScribe

## Prerequisites

1. **Environment Setup**
   - Backend `.env` configured (see `.env.example`)
   - Frontend `.env` configured (see `.env.example`)
   - MongoDB running (local or Atlas)
   - Node.js 18+ installed

2. **Install Dependencies**
   ```bash
   # Backend
   cd backend
   npm install
   
   # Frontend
   cd frontend
   npm install
   ```

## Quick Start (Development)

### Terminal 1 - Backend
```bash
cd backend
npm run dev
```
Expected output:
```
ðŸš€ Server running in development mode on port 5000
ðŸ“š API Documentation available at http://localhost:5000/api-docs
ðŸ”Œ Socket.IO initialized and ready
MongoDB Connected: ...
```

### Terminal 2 - Frontend
```bash
cd frontend
npm run dev
```
Expected output:
```
VITE v7.x.x ready in xxx ms
âžœ  Local:   http://localhost:3000/
```

## Test Scenarios

### 1. Authentication Flow

#### Register New User
1. Navigate to http://localhost:3000/register
2. Fill form:
   - Name: Test User
   - Email: test@example.com
   - Password: Test123!
3. Click "Register"
4. **Expected**: Redirect to Dashboard

#### Login
1. Navigate to http://localhost:3000/login
2. Enter credentials from registration
3. Click "Login"
4. **Expected**: Redirect to Dashboard with user list

#### Logout
1. On Dashboard, click "Logout"
2. **Expected**: Redirect to Login page

### 2. Video Room Flow

#### Create/Join Room
1. Login to Dashboard
2. Enter room name (e.g., "test-room-123")
3. Click "Join Room"
4. **Expected**:
   - LiveKit room loads
   - Camera/mic permissions requested
   - Video tile appears
   - "Enable Audio" button present

#### Audio/Video Controls
1. In room, click camera icon to toggle video
2. Click microphone icon to toggle audio
3. Click "Enable Audio" if autoplay blocked
4. **Expected**: Controls work smoothly

#### Test with Multiple Participants
1. Open second browser (or incognito window)
2. Login with different account
3. Join same room
4. **Expected**:
   - Both participants see each other
   - Audio/video streams work
   - Chat available

### 3. Transcription Features

#### Manual Transcript
1. In video room, click "Show Transcripts"
2. Transcript panel opens on right
3. Speak into microphone
4. **Expected**:
   - (Requires LiveKit cloud recording enabled)
   - Transcripts appear in panel
   - Scroll to view history

#### AI Summary
1. In transcript panel with some transcripts
2. Click "Generate Summary"
3. Wait for processing
4. **Expected**:
   - Loading indicator
   - Summary generated by OpenAI
   - Displayed in panel

#### Realtime Transcription (Sarvam AI)
1. Set `TRANSCRIPTION_PROVIDER=sarvam` in backend `.env`
2. Configure `SARVAM_API_KEY` and `SARVAM_REALTIME_URL`
3. In video room, start realtime transcription
4. **Expected**:
   - Microphone access requested
   - Recording indicator appears
   - Partial transcripts stream in realtime
   - Final transcripts displayed

### 4. Alerts & Threat Detection

#### Trigger Alert
1. In video call, say test phrases (configured in backend)
2. Check transcript panel
3. **Expected**:
   - Alert badge appears
   - Alert details shown in panel
   - Real-time notification via Socket.IO

### 5. Socket.IO Real-time Features

#### Test Socket Connection
1. Open browser dev console (F12)
2. Navigate to Dashboard
3. **Expected**: No socket errors in console

#### Test Real-time Updates
1. User A in Dashboard
2. User B joins a call
3. **Expected**: User A sees User B's online status update

### 6. Error Handling

#### Test Error Boundary
1. Temporarily break a component (add `throw new Error('test')`)
2. Navigate to that page
3. **Expected**:
   - Error boundary catches error
   - Friendly error UI displayed
   - "Reload Application" button works

#### Test Network Errors
1. Stop backend server
2. Try to login/join room
3. **Expected**: Graceful error messages

#### Test Invalid Room
1. Manually navigate to `/room/invalid-room-xyz`
2. **Expected**: Error or redirect to dashboard

## API Testing

### Health Check
```bash
curl http://localhost:5000/api/health
```

### Register User (API)
```bash
curl -X POST http://localhost:5000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"name":"API Test","email":"apitest@example.com","password":"Test123!"}'
```

### Login (API)
```bash
curl -X POST http://localhost:5000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"apitest@example.com","password":"Test123!"}'
```

### Swagger Documentation
Visit: http://localhost:5000/api-docs

## Performance Testing

### Frontend Bundle Size
```bash
cd frontend
npm run build
```
Check `dist/` folder - total should be < 1MB gzipped

### Backend Load Test (Optional)
Use tools like Apache Bench or Artillery:
```bash
ab -n 100 -c 10 http://localhost:5000/api/health
```

## Debugging Tips

### Backend Logs
- Check terminal for Winston logs
- Errors logged with stack traces
- Socket.IO connection logs visible

### Frontend Debug
- Open DevTools Console (F12)
- Check Network tab for API calls
- React DevTools for component state
- LiveKit debug: add `?debug=true` to room URL

### Common Issues

**CORS Errors**
- Verify `FRONTEND_URLS` in backend `.env`
- Check browser console for blocked origins
- Restart backend after `.env` changes

**LiveKit Connection Failed**
- Verify `LIVEKIT_URL`, `LIVEKIT_API_KEY`, `LIVEKIT_API_SECRET`
- Check LiveKit dashboard for project status
- Ensure WebSocket (wss://) accessible

**MongoDB Connection Failed**
- Verify `MONGODB_URI` format
- Check network/firewall rules
- For Atlas: whitelist IP address

**Audio/Video Not Working**
- Grant browser permissions
- Check HTTPS requirement (LiveKit needs HTTPS in production)
- Test with different browser

**Transcription Not Working**
- Verify `OPENAI_API_KEY` valid
- Check API quota/billing
- For Sarvam: verify endpoint and protocol

## Test Checklist

- [ ] User registration works
- [ ] User login works
- [ ] Dashboard loads with user list
- [ ] Can create/join video room
- [ ] Camera and mic controls work
- [ ] Can see remote participants
- [ ] Audio/video streams properly
- [ ] Chat messages send/receive
- [ ] Transcripts appear (if recording enabled)
- [ ] AI summary generates
- [ ] Realtime transcription works (if Sarvam configured)
- [ ] Alerts trigger correctly
- [ ] Socket.IO updates in real-time
- [ ] Error boundaries catch errors
- [ ] Mobile responsive (test on phone)
- [ ] Production build succeeds
- [ ] No console errors in normal flow

## Next Steps After Testing

1. Fix any discovered bugs
2. Optimize performance bottlenecks
3. Add integration tests (Jest/Cypress)
4. Set up CI/CD pipeline
5. Deploy to staging environment
6. Conduct user acceptance testing
7. Deploy to production

## Support

For issues:
1. Check browser console
2. Check backend logs
3. Review error messages
4. Consult API documentation: http://localhost:5000/api-docs
5. Check LiveKit documentation: https://docs.livekit.io
